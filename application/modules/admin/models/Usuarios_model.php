<?phpclass Usuarios_model extends CI_Model {    public function __construct() {        $this->load->database();    }    function login($usuario, $clave) {        $this->db->select('ID_USUARIO, USUARIO, CLAVE');        $this->db->from('admin_usuarios');        $this->db->where('ESTADO', 1);        $this->db->where('USUARIO', $usuario);        $this->db->where('CLAVE', MD5($clave));        $this->db->limit(1);        $query = $this->db->get();                if ($query->num_rows() == 1)         {            return $query->result();        }         else         {            return false;        }    }        public function buscar_usuario($usuario, $idUsuario=NULL) {        if ($usuario === null) {            return null;        } else {            $this->db->select('admin_usuarios.ID_USUARIO');            $this->db->from('admin_usuarios');            $this->db->where('admin_usuarios.USUARIO', $usuario);            if ($idUsuario) {                $this->db->where('admin_usuarios.ID_USUARIO <>', $idUsuario);            }            $query = $this->db->get();            return $query->row_array();        }    }    public function buscar_usuarios($data = array()) {        $arrayParametros = array();        $arrayParametros['usuario'] = $data['usuario'] != '' ? '%' . $data['usuario'] . '%' : NULL;        $arrayParametros['nombre_completo'] = $data['nombre_completo'] != '' ? '%' . $data['nombre_completo'] . '%' : NULL;        $arrayParametros['nro_documento'] = $data['nro_documento'] != '' ? '%' . $data['nro_documento'] . '%' : NULL;        $this->db->select('*');        $this->db->from('admin_usuarios');        if ($arrayParametros['usuario'] != NULL) {            $this->db->where('admin_usuarios.USUARIO like', $arrayParametros['usuario']);        }        if ($arrayParametros['nombre_completo'] != NULL) {            $this->db->where('admin_usuarios.NOMBRE_COMPLETO like', $arrayParametros['nombre_completo']);        }        if ($arrayParametros['nro_documento'] != NULL) {            $this->db->where('admin_usuarios.NRO_DOCUMENTO like', $arrayParametros['nro_documento']);        }        $consulta = $this->db->get();        $resultado = $consulta->result_array();        return $resultado;    }    public function obtener_datos_usuario($idUsuario) {        $this->db->select('admin_usuarios.*, ');        $this->db->from('admin_usuarios');        $this->db->where('admin_usuarios.ID_USUARIO', $idUsuario);        $query = $this->db->get();        return $query->row_array();    }         public function crearUsuario($data)     {        $this->db->insert('admin_usuarios', $data);        return $this->db->insert_id();    }    public function actualizarUsuario($data, $idUsuario)     {        $this->db->where('admin_usuarios.ID_USUARIO', $idUsuario);        $this->db->update('admin_usuarios', $data);    }        public function generarClave()     {        //sha1 me da el hash de la cadena, es una codificacion          //uniqid genera un id unico        //mt_ran genera un numero aleatorio(numero inicial, numero final) incluye los extremos        $clave=sha1(uniqid(mt_rand(), true));         return $clave;    }        public function crearActualizarUsuario($idUsuario,$data)     {        if($idUsuario == NULL)        {            //$clave = $this->generarClave();            $clave = "Lendan.2016";            $data['ESTADO'] = 1;            $data['CLAVE'] = md5($clave);            $idUsuario = $this->crearUsuario($data);                        $data['CLAVE_SIN_CIFRAR'] = $clave;            $data['ID_USUARIO'] = $idUsuario;        }        else        {            $this->actualizarUsuario($data, $idUsuario);        }        return $data;            }}