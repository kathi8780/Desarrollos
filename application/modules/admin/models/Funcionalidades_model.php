<?phpclass Funcionalidades_model extends CI_Model {    public function __construct() {        $this->load->database();    }      public function buscar_funcionalidades($idModulo = NUll) {                $this->db->select("*");        $this->db->from('admin_funcionalidades');               $this->db->join('admin_modulo_funcionalidad','admin_modulo_funcionalidad.ID_FUNCIONALIDAD = admin_funcionalidades.ID_FUNCIONALIDAD');               if($idModulo)            $this->db->where('admin_modulo_funcionalidad.ID_MODULO',$idModulo);                $consulta = $this->db->get();        $resultado = $consulta->result_array();        return $resultado;    }    public function buscar_funcionalidades_x_rol_modulo($idRol,$idModulo = NUll) {                $this->db->select("admin_funcionalidades.FUNCIONALIDAD,                            admin_funcionalidades.ID_FUNCIONALIDAD,                            admin_rol_funcionalidad.ID_FUNCIONALIDAD AS IS_CHECKED");        $this->db->from('admin_funcionalidades');               $this->db->join('admin_modulo_funcionalidad','admin_modulo_funcionalidad.ID_FUNCIONALIDAD = admin_funcionalidades.ID_FUNCIONALIDAD');               $this->db->join('admin_rol_funcionalidad','admin_rol_funcionalidad.ID_FUNCIONALIDAD = admin_funcionalidades.ID_FUNCIONALIDAD');               $this->db->where('admin_rol_funcionalidad.ID_ROL',$idRol);        $this->db->where('admin_modulo_funcionalidad.ID_MODULO',$idModulo);                 $consulta = $this->db->get();        $funcionalidaesCheckeadas = $consulta->result_array();                $idFuncionalidaesCheckeadas = array();        foreach ($funcionalidaesCheckeadas as $funcionalidad) {           $idFuncionalidaesCheckeadas[] = $funcionalidad['ID_FUNCIONALIDAD'] ;         }               $this->db->select("admin_funcionalidades.FUNCIONALIDAD,                            admin_funcionalidades.ID_FUNCIONALIDAD");        $this->db->from('admin_funcionalidades');        $this->db->join('admin_modulo_funcionalidad','admin_modulo_funcionalidad.ID_FUNCIONALIDAD = admin_funcionalidades.ID_FUNCIONALIDAD');        $this->db->where('admin_modulo_funcionalidad.ID_MODULO',$idModulo);        if(count($funcionalidaesCheckeadas)>0)        {            $this->db->where_not_in('admin_funcionalidades.ID_FUNCIONALIDAD',$idFuncionalidaesCheckeadas);                    }        $consulta1 = $this->db->get();        $funcionalidesNoCheckeadas = $consulta1->result_array();                return array_merge($funcionalidaesCheckeadas,$funcionalidesNoCheckeadas);    }}